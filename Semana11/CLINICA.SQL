
DROP TABLE dbo.ALTA
go



DROP TABLE dbo.VISITA
go



DROP TABLE dbo.INGRESO
go



DROP TABLE dbo.PACIENTE
go



DROP TABLE dbo.PERSONAL
go



CREATE TABLE dbo.PERSONAL
( 
	IDPERSONAL           integer IDENTITY ( 1,1 ) ,
	NOMBRE               varchar(50)  NOT NULL ,
	APELLIDO             varchar(50)  NOT NULL ,
	TIPO                 char(1)  NOT NULL 
	CONSTRAINT CHK_PERSONAL_TIPO
		CHECK  ( [TIPO]='M' OR [TIPO]='E' ),
	USUARIO              varchar(20)  NOT NULL ,
	CLAVE                varchar(20)  NOT NULL ,
	CONSTRAINT XPKPERSONAL PRIMARY KEY  CLUSTERED (IDPERSONAL ASC),
	CONSTRAINT XAK1PERSONAL UNIQUE (USUARIO  ASC)
)
go



CREATE TABLE dbo.PACIENTE
( 
	IDPACIENTE           integer IDENTITY ( 1,1 ) ,
	NOMBRE               varchar(50)  NOT NULL ,
	APELLIDO             varchar(50)  NOT NULL ,
	IDPERSONAL           integer  NOT NULL ,
	CONSTRAINT XPKPACIENTE PRIMARY KEY  CLUSTERED (IDPACIENTE ASC),
	CONSTRAINT FK_PACIENTE_PERSONAL FOREIGN KEY (IDPERSONAL) REFERENCES dbo.PERSONAL(IDPERSONAL)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE dbo.INGRESO
( 
	IDINGRESO            integer IDENTITY ( 1,1 ) ,
	IDPERSONAL           integer  NOT NULL ,
	IDPACIENTE           integer  NOT NULL ,
	FECHA                datetime  NOT NULL ,
	HABITACION           integer  NOT NULL ,
	GLOSA                varchar(1500)  NOT NULL ,
	CONSTRAINT XPKINGRESO PRIMARY KEY  CLUSTERED (IDINGRESO ASC),
	CONSTRAINT FK_INGRESO_MEDICO FOREIGN KEY (IDPERSONAL) REFERENCES dbo.PERSONAL(IDPERSONAL)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_INGRESO_PACIENTE FOREIGN KEY (IDPACIENTE) REFERENCES dbo.PACIENTE(IDPACIENTE)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE dbo.VISITA
( 
	IDVISITA             integer IDENTITY ( 1,1 ) ,
	IDPERSONAL           integer  NOT NULL ,
	IDINGRESO            integer  NOT NULL ,
	FECHA                datetime  NOT NULL ,
	GLOSA                varchar(1500)  NOT NULL ,
	CONSTRAINT XPKVISITA PRIMARY KEY  CLUSTERED (IDVISITA ASC),
	CONSTRAINT FK_VISITA_MEDICO FOREIGN KEY (IDPERSONAL) REFERENCES dbo.PERSONAL(IDPERSONAL)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_VISITA_INGRESO FOREIGN KEY (IDINGRESO) REFERENCES dbo.INGRESO(IDINGRESO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE dbo.ALTA
( 
	IDINGRESO            integer  NOT NULL ,
	IDPERSONAL           integer  NOT NULL ,
	FECHA                datetime  NOT NULL ,
	GLOSA                varchar(1500)  NOT NULL ,
	CONSTRAINT XPKALTA PRIMARY KEY  CLUSTERED (IDINGRESO ASC),
	CONSTRAINT FK_ALTA_MEDICO FOREIGN KEY (IDPERSONAL) REFERENCES dbo.PERSONAL(IDPERSONAL)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_ALTA_INGRESO FOREIGN KEY (IDINGRESO) REFERENCES dbo.INGRESO(IDINGRESO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go


